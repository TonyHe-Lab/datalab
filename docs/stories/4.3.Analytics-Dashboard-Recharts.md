---
title: "Story 4.3: Analytics Dashboard with Recharts"
epic: 4
story: 3
status: Draft
---

## Story

**As a** maintenance manager,
**I want** an analytics dashboard with charts and metrics,
**so that** I can monitor equipment reliability and identify trends in故障 patterns.

## Acceptance Criteria

AC-1: Dashboard layout
- Validation steps: Implement grid layout with KPI cards and charts
- Pass condition: Layout is responsive and follows design specification

AC-2: KPI cards
- Validation steps: Display key metrics (MTBF, Total Failures, Top Component, Last Sync)
- Pass condition: Cards show correct values with appropriate formatting

AC-3: Reliability trend chart
- Validation steps: Implement line chart showing MTBF over time
- Pass condition: Chart displays time series data with proper axes

AC-4: Component analysis charts
- Validation steps: Create bar chart for top failing components and pie chart for fault distribution
- Pass condition: Charts visualize data correctly with labels

AC-5: Filter controls
- Validation steps: Add date range picker and device model selector
- Pass condition: Filters update dashboard data appropriately

## Tasks / Subtasks

- [ ] Task 1: Implement dashboard layout (AC: 1)
  - [ ] Create DashboardPage component with grid layout
  - [ ] Use Ant Design Row/Col for responsive grid
  - [ ] Implement proper spacing and card containers
  - [ ] Test responsive behavior at different screen sizes

- [ ] Task 2: Create KPI cards (AC: 2)
  - [ ] Implement KPICard component for metric display
  - [ ] Create cards for MTBF, Total Failures, Top Component, Last Sync
  - [ ] Add iconography and value formatting
  - [ ] Implement loading states for async data

- [ ] Task 3: Implement reliability trend chart (AC: 3)
  - [ ] Create ReliabilityTrendChart component with Recharts
  - [ ] Configure line chart with time series data
  - [ ] Add axes, grid, and tooltip
  - [ ] Implement responsive container

- [ ] Task 4: Create component analysis charts (AC: 4)
  - [ ] Implement TopComponentsChart as horizontal bar chart
  - [ ] Create FaultDistributionChart as pie chart
  - [ ] Add legends and labels for clarity
  - [ ] Ensure charts are properly sized and responsive

- [ ] Task 5: Implement filter controls (AC: 5)
  - [ ] Add DatePicker.RangePicker for time filtering
  - [ ] Create Select component for device model filtering
  - [ ] Implement filter state management
  - [ ] Add apply/reset filter functionality

- [ ] Task 6: API integration and data processing (AC: 2,3,4,5)
  - [ ] Create analytics service for /api/analytics endpoints
  - [ ] Implement data transformation for chart formats
  - [ ] Add React Query for data fetching and caching
  - [ ] Create error handling for failed requests

## Dev Notes

### Previous Story Insights
- Story 4.1: React app setup and routing [Source: docs/stories/4.1.React-App-Setup-Ant-Design.md]
- Story 3.4: Analytics SQL views and endpoints [Source: docs/stories/3.4.Analytics-SQL-Views-Endpoints.md]
- Story 4.2: API service patterns and React Query usage [Source: docs/stories/4.2.Diagnostic-Workbench-UI-Implementation.md]

### Data Models
From analytics endpoints:
- MTBF data: { date: string, mtbf: number, equipment_id: string } [Source: docs/stories/3.4.Analytics-SQL-Views-Endpoints.md]
- Pareto data: { component: string, count: number, percentage: number } [Source: docs/stories/3.4.Analytics-SQL-Views-Endpoints.md]
- Dashboard summary: { mtbf: number, total_failures: number, top_component: string, last_sync: string } [Source: docs/UX Master Prompt.md#Core-Pages-to-Implement]
- Filter parameters: { start_date: string, end_date: string, equipment_model: string } [Source: docs/UX Master Prompt.md#Core-Pages-to-Implement]

### API Specifications
From analytics implementation:
- GET /api/analytics/mtbf - MTBF time series data [Source: docs/stories/3.4.Analytics-SQL-Views-Endpoints.md]
- GET /api/analytics/pareto - Pareto distribution data [Source: docs/stories/3.4.Analytics-SQL-Views-Endpoints.md]
- GET /api/analytics/summary - Dashboard summary metrics [Source: docs/UX Master Prompt.md#Core-Pages-to-Implement]
- Date range and equipment filtering support [Source: docs/UX Master Prompt.md#Core-Pages-to-Implement]

### File Locations
Based on project structure:
- `frontend/src/pages/DashboardPage.tsx` - Main dashboard page
- `frontend/src/components/KPICard.tsx` - Metric display card
- `frontend/src/components/ReliabilityTrendChart.tsx` - MTBF line chart
- `frontend/src/components/TopComponentsChart.tsx` - Pareto bar chart
- `frontend/src/components/FaultDistributionChart.tsx` - Fault pie chart
- `frontend/src/components/DashboardFilters.tsx` - Filter controls
- `frontend/src/services/analyticsService.ts` - Analytics API service
- `frontend/src/types/analytics.ts` - TypeScript types for analytics data

### Testing Requirements
From architecture.md testing strategy:
- Unit tests for chart components
- Integration tests for analytics services
- Data transformation tests
- Responsive layout testing
- Filter interaction testing

### Technical Constraints
- Recharts library for data visualization [Source: docs/UX Master Prompt.md#Technical-Constraints]
- ResponsiveContainer for chart responsiveness [Source: docs/UX Master Prompt.md#Technical-Constraints]
- Ant Design grid system for layout [Source: docs/UX Master Prompt.md#Technical-Constraints]
- Compact design with high information density [Source: docs/UX Master Prompt.md#Theme-&-Styling]
- Date range filtering with Ant Design DatePicker [Source: docs/UX Master Prompt.md#Core-Pages-to-Implement]

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-28 | 1.0 | Initial story creation | Scrum Master |
